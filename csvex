import org.apache.poi.ss.usermodel.*;
import org.apache.poi.ss.util.CellRangeAddress;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.FileOutputStream;
import java.io.IOException;

public class ExcelCreator {

    public static void main(String[] args) throws IOException {

        // Create a new workbook and sheet
        XSSFWorkbook workbook = new XSSFWorkbook();
        XSSFSheet sheet = workbook.createSheet("Design");

        // Create a bold font for headers
        Font headerFont = workbook.createFont();
        headerFont.setBold(true);
        
        // Create a cell style for headers with thick borders
        CellStyle thickBorderStyle = workbook.createCellStyle();
        thickBorderStyle.setFont(headerFont);
        thickBorderStyle.setBorderBottom(BorderStyle.THICK);
        thickBorderStyle.setBorderTop(BorderStyle.THICK);
        thickBorderStyle.setBorderLeft(BorderStyle.THICK);
        thickBorderStyle.setBorderRight(BorderStyle.THICK);

        // Create a cell style with thick right border only (to separate sections)
        CellStyle thickRightBorderStyle = workbook.createCellStyle();
        thickRightBorderStyle.setBorderRight(BorderStyle.THICK);

        // Create the first row (Header) and the columns "Pillar", "APM", "APPLOG"
        Row headerRow = sheet.createRow(0);
        String[] headers = {"Pillar", "APM", "APPLOG"};
        for (int i = 0; i < headers.length; i++) {
            Cell cell = headerRow.createCell(i);
            cell.setCellValue(headers[i]);
            cell.setCellStyle(thickBorderStyle);
        }

        // Create the second row (Subheaders for Questionnaire)
        Row subHeaderRow = sheet.createRow(1);
        String[] subHeaders = {"APPID", "Q1", "Q2", "Q3", "Q1", "Q2"};
        for (int i = 0; i < subHeaders.length; i++) {
            Cell cell = subHeaderRow.createCell(i);
            cell.setCellValue(subHeaders[i]);

            // Apply thick border at specific columns for APM and APPLOG
            if (i == 3 || i == 5) { // After APM Q3 (index 3) and after APPLOG Q2 (index 5)
                cell.setCellStyle(thickRightBorderStyle); // Apply thick right border
            } else {
                cell.setCellStyle(thickBorderStyle);
            }
        }

        // Merge cells for the "Pillar" and sections for APM and APPLOG
        sheet.addMergedRegion(new CellRangeAddress(0, 1, 0, 0)); // Pillar
        sheet.addMergedRegion(new CellRangeAddress(0, 0, 1, 3)); // APM
        sheet.addMergedRegion(new CellRangeAddress(0, 0, 4, 5)); // APPLOG

        // Resize columns
        for (int i = 0; i < headers.length; i++) {
            sheet.autoSizeColumn(i);
        }

        // Write the output to a file
        try (FileOutputStream fileOut = new FileOutputStream("Design.xlsx")) {
            workbook.write(fileOut);
        }

        workbook.close();
        System.out.println("Excel file created successfully!");
    }
}
