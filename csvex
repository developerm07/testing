import org.apache.poi.ss.usermodel.*;
import org.apache.poi.ss.util.CellRangeAddress;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.FileOutputStream;
import java.io.IOException;

public class ExcelCreator {

    public static void main(String[] args) throws IOException {

        // Create a new workbook and sheet
        XSSFWorkbook workbook = new XSSFWorkbook();
        XSSFSheet sheet = workbook.createSheet("Design");

        // Create a bold font for headers
        Font headerFont = workbook.createFont();
        headerFont.setBold(true);
        
        // Create a cell style for headers with thick borders
        CellStyle thickBorderStyle = workbook.createCellStyle();
        thickBorderStyle.setFont(headerFont);
        thickBorderStyle.setBorderBottom(BorderStyle.THICK);
        thickBorderStyle.setBorderTop(BorderStyle.THICK);
        thickBorderStyle.setBorderLeft(BorderStyle.THICK);
        thickBorderStyle.setBorderRight(BorderStyle.THICK);

        // Create a cell style with thick right border only (to separate sections)
        CellStyle thickRightBorderStyle = workbook.createCellStyle();
        thickRightBorderStyle.setBorderRight(BorderStyle.THICK);

        // Create the first row (Header) and merge cells for Pillar
        Row headerRow = sheet.createRow(0);
        Cell pillarCell = headerRow.createCell(0);
        pillarCell.setCellValue("Pillar");
        pillarCell.setCellStyle(thickBorderStyle);
        sheet.addMergedRegion(new CellRangeAddress(0, 0, 0, 2)); // Merge Pillar across 3 columns

        // Add APM and APPLOG headers to the first row
        Cell apmCell = headerRow.createCell(3);
        apmCell.setCellValue("APM");
        apmCell.setCellStyle(thickBorderStyle);
        sheet.addMergedRegion(new CellRangeAddress(0, 0, 3, 5)); // Merge APM across 3 columns

        Cell appLogCell = headerRow.createCell(6);
        appLogCell.setCellValue("APPLOG");
        appLogCell.setCellStyle(thickBorderStyle);
        sheet.addMergedRegion(new CellRangeAddress(0, 0, 6, 7)); // Merge APPLOG across 2 columns

        // Create the second row (Subheaders for Questionnaire)
        Row subHeaderRow = sheet.createRow(1);
        String[] subHeaders = {"APPID", "Q1", "Q2", "Q3", "Q1", "Q2"};
        for (int i = 0; i < subHeaders.length; i++) {
            Cell cell = subHeaderRow.createCell(i);
            cell.setCellValue(subHeaders[i]);

            // Apply thick border at specific columns for APM and APPLOG
            if (i == 2 || i == 5 || i == 7) { // After Pillar, APM Q3 (index 5), and APPLOG Q2 (index 7)
                cell.setCellStyle(thickRightBorderStyle); // Apply thick right border
            } else {
                cell.setCellStyle(thickBorderStyle);
            }
        }

        // Merge cells for APPID column under Pillar
        sheet.addMergedRegion(new CellRangeAddress(1, 1, 0, 2)); // Merge APPID across 3 columns under Pillar

        // Resize columns
        for (int i = 0; i < 8; i++) {
            sheet.autoSizeColumn(i);
        }

        // Write the output to a file
        try (FileOutputStream fileOut = new FileOutputStream("Design.xlsx")) {
            workbook.write(fileOut);
        }

        workbook.close();
        System.out.println("Excel file created successfully!");
    }
}
